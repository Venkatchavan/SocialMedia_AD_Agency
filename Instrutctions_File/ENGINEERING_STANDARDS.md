# ENGINEERING_STANDARDS.md

## Hard Engineering Clause
**No piece of code (single file/module/script) may exceed 250 lines.**
- If it grows >250 lines: refactor into smaller modules.
- Exception: autogenerated files (still discouraged). Do not hand-edit.
- PRs that violate this rule fail review.

## Repo Structure (Suggested)
workspace/
  core/
    config.py
    schemas.py
    logging.py
    errors.py
    utils.py
  collectors/
    tiktok_client.py
    meta_client.py
  analyzers/
    media_analyzer.py
    comment_miner.py
    tagger.py
  synthesis/
    clustering.py
    insights.py
  briefs/
    template_engine.py
    brief_writer.py
  qa/
    pii_redaction.py
    claim_checks.py
    no_copy_checks.py
  export/
    exporter_md.py
    exporter_json.py
  orchestration/
    crew.py
    scheduler.py

## Quality Gates
- Typed boundaries (pydantic/dataclasses preferred)
- JSON schema validation at every stage
- Deterministic tagging taxonomy (no free-form tags)
- Rate limits + timeouts on collectors
- Retry with jitter (bounded)
- Audit logs for: collect/analyze/export

## Security Baselines
- Secrets in env vars only (never logs)
- URL allowlist + SSRF protections
- Output sanitization (XSS-safe rendering)
- Least privilege DB roles

## Testing Baselines
- Unit tests for: schemas, tagger, redaction, template engine
- Golden-set regression test for tagging + brief sections
- Mock collectors for CI (no live scraping in tests)